Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 6.6.87.2-microsoft-standard-WSL2 x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Wed Jul 23 15:01:46 CEST 2025

  System load:  0.0                 Processes:             71
  Usage of /:   4.4% of 1006.85GB   Users logged in:       0
  Memory usage: 2%                  IPv4 address for eth0: 172.18.72.98
  Swap usage:   0%

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar for easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

This message is shown once a day. To disable it please create the
/home/user/.hushlogin file.
(base) user@KirianPC:~$ ls
HandsOnProject_11  cuda-repo-wsl-ubuntu-12-9-local_12.9.0-1_amd64.deb  gsplat  gsplat-env  miniconda3
(base) user@KirianPC:~$ cd HandsOnProject_11/
(base) user@KirianPC:~/HandsOnProject_11$ ls
HandsOn_Project_11  deep-geometric-prior
(base) user@KirianPC:~/HandsOnProject_11$ cd HandsOn_Project_11/
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ ls
GeoSPSR  README.md
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ conda env list

# conda environments:
#
                       /home/user/HandsOnProject_11/deep-geometric-prior/y
base                 * /home/user/miniconda3
GeoSPSR                /home/user/miniconda3/envs/GeoSPSR
dgp                    /home/user/miniconda3/envs/dgp
dgp_new                /home/user/miniconda3/envs/dgp_new

(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ python --version
Python 3.13.5
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ nvidia-smi
Wed Jul 23 15:04:04 2025
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.64.01              Driver Version: 576.80         CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 3080        On  |   00000000:09:00.0  On |                  N/A |
| 57%   49C    P0             94W /  370W |    2670MiB /  10240MiB |      6%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A              39      G   /Xwayland                             N/A      |
+-----------------------------------------------------------------------------------------+
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ sudo apt update
 install pipx
pipx ensurepath
[sudo] password for user:
Sorry, try again.
[sudo] password for user:
Get:1 file:/var/cuda-repo-wsl-ubuntu-12-9-local  InRelease [1572 B]
Get:1 file:/var/cuda-repo-wsl-ubuntu-12-9-local  InRelease [1572 B]
Get:2 http://security.ubuntu.com/ubuntu jammy-security InRelease [129 kB]
Hit:3 http://archive.ubuntu.com/ubuntu jammy InRelease
Get:4 http://archive.ubuntu.com/ubuntu jammy-updates InRelease [128 kB]
Get:5 http://archive.ubuntu.com/ubuntu jammy-backports InRelease [127 kB]
Get:6 http://security.ubuntu.com/ubuntu jammy-security/main amd64 Packages [2518 kB]
Get:7 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages [2763 kB]
Get:8 http://security.ubuntu.com/ubuntu jammy-security/main Translation-en [374 kB]
Get:9 http://security.ubuntu.com/ubuntu jammy-security/restricted amd64 Packages [3912 kB]
Get:10 http://archive.ubuntu.com/ubuntu jammy-updates/main Translation-en [438 kB]
Get:11 http://archive.ubuntu.com/ubuntu jammy-updates/restricted amd64 Packages [4058 kB]
Get:12 http://security.ubuntu.com/ubuntu jammy-security/restricted Translation-en [708 kB]
Get:13 http://security.ubuntu.com/ubuntu jammy-security/universe amd64 Packages [992 kB]
Get:14 http://security.ubuntu.com/ubuntu jammy-security/universe Translation-en [216 kB]
Get:15 http://archive.ubuntu.com/ubuntu jammy-updates/restricted Translation-en [734 kB]
Get:16 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 Packages [1225 kB]
Get:17 http://archive.ubuntu.com/ubuntu jammy-updates/universe Translation-en [303 kB]
Fetched 18.6 MB in 3s (7263 kB/s)
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
7 packages can be upgraded. Run 'apt list --upgradable' to see them.
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ sudo apt update
Get:1 file:/var/cuda-repo-wsl-ubuntu-12-9-local  InRelease [1572 B]
Get:1 file:/var/cuda-repo-wsl-ubuntu-12-9-local  InRelease [1572 B]
Hit:2 http://archive.ubuntu.com/ubuntu jammy InRelease
Hit:3 http://security.ubuntu.com/ubuntu jammy-security InRelease
Hit:4 http://archive.ubuntu.com/ubuntu jammy-updates InRelease
Hit:5 http://archive.ubuntu.com/ubuntu jammy-backports InRelease
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
7 packages can be upgraded. Run 'apt list --upgradable' to see them.
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ sudo apt install pipx
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  fonts-font-awesome fonts-lato libjs-bootstrap4 libjs-highlight.js libjs-lunr libjs-modernizr libjs-popper.js
  libjs-sizzle mkdocs node-jquery python3-argcomplete python3-livereload python3-markdown python3-packaging
  python3-psutil python3-pygments python3-pyinotify python3-tornado python3-userpath sphinx-rtd-theme-common
Suggested packages:
  libjs-es5-shim ghp-import mkdocs-doc nodejs coffeescript node-less node-uglify python-livereload-doc python3-django
  python3-flask python3-slimmer python-markdown-doc python-psutil-doc python-pygments-doc ttf-bitstream-vera
  python-pyinotify-doc python-tornado-doc
The following NEW packages will be installed:
  fonts-font-awesome fonts-lato libjs-bootstrap4 libjs-highlight.js libjs-lunr libjs-modernizr libjs-popper.js
  libjs-sizzle mkdocs node-jquery pipx python3-argcomplete python3-livereload python3-markdown python3-packaging
  python3-psutil python3-pygments python3-pyinotify python3-tornado python3-userpath sphinx-rtd-theme-common
0 upgraded, 21 newly installed, 0 to remove and 7 not upgraded.
Need to get 7276 kB of archives.
After this operation, 32.2 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 fonts-lato all 2.0-2.1 [2696 kB]
Get:2 http://archive.ubuntu.com/ubuntu jammy/main amd64 fonts-font-awesome all 5.0.10+really4.7.0~dfsg-4.1 [516 kB]
Get:3 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libjs-popper.js all 1.16.1+ds-5 [53.8 kB]
Get:4 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libjs-bootstrap4 all 4.6.0+dfsg1-4 [534 kB]
Get:5 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libjs-highlight.js all 9.18.5+dfsg1-1 [367 kB]
Get:6 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libjs-lunr all 2.3.9~dfsg-1 [67.0 kB]
Get:7 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libjs-sizzle all 2.3.6+ds+~2.3.3-1 [32.3 kB]
Get:8 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libjs-modernizr all 2.6.2+ds1-4 [47.1 kB]
Get:9 http://archive.ubuntu.com/ubuntu jammy/main amd64 sphinx-rtd-theme-common all 1.0.0+dfsg-1 [991 kB]
Get:10 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-tornado amd64 6.1.0-3build1 [287 kB]
Get:11 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-livereload all 2.6.3-2 [24.7 kB]
Get:12 http://archive.ubuntu.com/ubuntu jammy/main amd64 python3-markdown all 3.3.6-1 [68.5 kB]
Get:13 http://archive.ubuntu.com/ubuntu jammy/universe amd64 mkdocs all 1.1.2+dfsg-2ubuntu1 [59.2 kB]
Get:14 http://archive.ubuntu.com/ubuntu jammy/universe amd64 node-jquery all 3.6.0+dfsg+~3.5.13-1 [160 kB]
Get:15 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-argcomplete all 1.8.1-1.5 [27.2 kB]
Get:16 http://archive.ubuntu.com/ubuntu jammy/main amd64 python3-packaging all 21.3-1 [30.7 kB]
Get:17 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-userpath all 1.8.0-1 [10.0 kB]
Get:18 http://archive.ubuntu.com/ubuntu jammy/universe amd64 pipx all 1.0.0-1 [371 kB]
Get:19 http://archive.ubuntu.com/ubuntu jammy/main amd64 python3-psutil amd64 5.9.0-1build1 [158 kB]
Get:20 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-pygments all 2.11.2+dfsg-2ubuntu0.1 [750 kB]
Get:21 http://archive.ubuntu.com/ubuntu jammy/main amd64 python3-pyinotify all 0.9.6-1.3 [24.8 kB]
Fetched 7276 kB in 1s (12.8 MB/s)
Selecting previously unselected package fonts-lato.
(Reading database ... 57600 files and directories currently installed.)
Preparing to unpack .../00-fonts-lato_2.0-2.1_all.deb ...
Unpacking fonts-lato (2.0-2.1) ...
Selecting previously unselected package fonts-font-awesome.
Preparing to unpack .../01-fonts-font-awesome_5.0.10+really4.7.0~dfsg-4.1_all.deb ...
Unpacking fonts-font-awesome (5.0.10+really4.7.0~dfsg-4.1) ...
Selecting previously unselected package libjs-popper.js.
Preparing to unpack .../02-libjs-popper.js_1.16.1+ds-5_all.deb ...
Unpacking libjs-popper.js (1.16.1+ds-5) ...
Selecting previously unselected package libjs-bootstrap4.
Preparing to unpack .../03-libjs-bootstrap4_4.6.0+dfsg1-4_all.deb ...
Unpacking libjs-bootstrap4 (4.6.0+dfsg1-4) ...
Selecting previously unselected package libjs-highlight.js.
Preparing to unpack .../04-libjs-highlight.js_9.18.5+dfsg1-1_all.deb ...
Unpacking libjs-highlight.js (9.18.5+dfsg1-1) ...
Selecting previously unselected package libjs-lunr.
Preparing to unpack .../05-libjs-lunr_2.3.9~dfsg-1_all.deb ...
Unpacking libjs-lunr (2.3.9~dfsg-1) ...
Selecting previously unselected package libjs-sizzle.
Preparing to unpack .../06-libjs-sizzle_2.3.6+ds+~2.3.3-1_all.deb ...
Unpacking libjs-sizzle (2.3.6+ds+~2.3.3-1) ...
Selecting previously unselected package libjs-modernizr.
Preparing to unpack .../07-libjs-modernizr_2.6.2+ds1-4_all.deb ...
Unpacking libjs-modernizr (2.6.2+ds1-4) ...
Selecting previously unselected package sphinx-rtd-theme-common.
Preparing to unpack .../08-sphinx-rtd-theme-common_1.0.0+dfsg-1_all.deb ...
Unpacking sphinx-rtd-theme-common (1.0.0+dfsg-1) ...
Selecting previously unselected package python3-tornado.
Preparing to unpack .../09-python3-tornado_6.1.0-3build1_amd64.deb ...
Unpacking python3-tornado (6.1.0-3build1) ...
Selecting previously unselected package python3-livereload.
Preparing to unpack .../10-python3-livereload_2.6.3-2_all.deb ...
Unpacking python3-livereload (2.6.3-2) ...
Selecting previously unselected package python3-markdown.
Preparing to unpack .../11-python3-markdown_3.3.6-1_all.deb ...
Unpacking python3-markdown (3.3.6-1) ...
Selecting previously unselected package mkdocs.
Preparing to unpack .../12-mkdocs_1.1.2+dfsg-2ubuntu1_all.deb ...
Unpacking mkdocs (1.1.2+dfsg-2ubuntu1) ...
Selecting previously unselected package node-jquery.
Preparing to unpack .../13-node-jquery_3.6.0+dfsg+~3.5.13-1_all.deb ...
Unpacking node-jquery (3.6.0+dfsg+~3.5.13-1) ...
Selecting previously unselected package python3-argcomplete.
Preparing to unpack .../14-python3-argcomplete_1.8.1-1.5_all.deb ...
Unpacking python3-argcomplete (1.8.1-1.5) ...####...................................................................]
Selecting previously unselected package python3-packaging.
Preparing to unpack .../15-python3-packaging_21.3-1_all.deb ...
Unpacking python3-packaging (21.3-1) ...
Selecting previously unselected package python3-userpath.
Preparing to unpack .../16-python3-userpath_1.8.0-1_all.deb ...
Unpacking python3-userpath (1.8.0-1) ...
Selecting previously unselected package pipx.
Preparing to unpack .../17-pipx_1.0.0-1_all.deb ...
Unpacking pipx (1.0.0-1) ...
Selecting previously unselected package python3-psutil.
Preparing to unpack .../18-python3-psutil_5.9.0-1build1_amd64.deb ...
Unpacking python3-psutil (5.9.0-1build1) ...
Selecting previously unselected package python3-pygments.
Preparing to unpack .../19-python3-pygments_2.11.2+dfsg-2ubuntu0.1_all.deb ...
Unpacking python3-pygments (2.11.2+dfsg-2ubuntu0.1) ...
Selecting previously unselected package python3-pyinotify.
Preparing to unpack .../20-python3-pyinotify_0.9.6-1.3_all.deb ...
Unpacking python3-pyinotify (0.9.6-1.3) ...
Setting up python3-tornado (6.1.0-3build1) ...
Setting up fonts-lato (2.0-2.1) ...
Setting up libjs-popper.js (1.16.1+ds-5) ...
Setting up libjs-lunr (2.3.9~dfsg-1) ...
Setting up python3-pyinotify (0.9.6-1.3) ...
Setting up libjs-sizzle (2.3.6+ds+~2.3.3-1) ...
Setting up libjs-modernizr (2.6.2+ds1-4) ...
Setting up python3-psutil (5.9.0-1build1) ...
Setting up python3-pygments (2.11.2+dfsg-2ubuntu0.1) ...
Setting up python3-packaging (21.3-1) ...
Setting up python3-markdown (3.3.6-1) ...
Setting up libjs-highlight.js (9.18.5+dfsg1-1) ...
Setting up python3-livereload (2.6.3-2) ...
Setting up libjs-bootstrap4 (4.6.0+dfsg1-4) ...
Setting up python3-argcomplete (1.8.1-1.5) ...
Setting up fonts-font-awesome (5.0.10+really4.7.0~dfsg-4.1) ...
Setting up sphinx-rtd-theme-common (1.0.0+dfsg-1) ...
Setting up node-jquery (3.6.0+dfsg+~3.5.13-1) ...
Setting up python3-userpath (1.8.0-1) ...
Setting up pipx (1.0.0-1) ...
Setting up mkdocs (1.1.2+dfsg-2ubuntu1) ...
Processing triggers for man-db (2.10.2-1) ...
Processing triggers for fontconfig (2.13.1-4.2ubuntu5) ...
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$












Progress: [ 99%] [######################################################################################################(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Pro(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ pipx ensurepath
Success! Added /home/user/.local/bin to the PATH environment variable.

Consider adding shell completions for pipx. Run 'pipx completions' for instructions.

You will need to open a new terminal or re-login for the PATH changes to take effect.

Otherwise pipx is ready to go! ✨ 🌟 ✨
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ exec $SHELL
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ pipx install uv
  installed package uv 0.8.2, installed using Python 3.10.12
  These apps are now globally available
    - uv
    - uvx
done! ✨ 🌟 ✨
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ uv --version
uv 0.8.2
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ ls
GeoSPSR  README.md
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ cd GeoSPSR/
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ uv venv GeoSPSR_uv
/bin/activateUsing CPython 3.13.5 interpreter at: /home/user/miniconda3/bin/python
Creating virtual environment at: GeoSPSR_uv
Activate with: source GeoSPSR_uv/bin/activate
(base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ source GeoSPSR_uv/bin/activate
(GeoSPSR_uv) (base) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ conda deactivate
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ uv pip install jax[cuda12] -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html
 flax tqdm matplotlib libigl gpytoolbox ipywidgets meshplot pythreejs
Using Python 3.13.5 environment at: GeoSPSR_uv
Resolved 20 packages in 502ms
Prepared 20 packages in 2m 07s
Installed 20 packages in 67ms
 + jax==0.7.0
 + jax-cuda12-pjrt==0.7.0
 + jax-cuda12-plugin==0.7.0
 + jaxlib==0.7.0
 + ml-dtypes==0.5.1
 + numpy==2.3.1
 + nvidia-cublas-cu12==12.9.1.4
 + nvidia-cuda-cupti-cu12==12.9.79
 + nvidia-cuda-nvcc-cu12==12.9.86
 + nvidia-cuda-nvrtc-cu12==12.9.86
 + nvidia-cuda-runtime-cu12==12.9.79
 + nvidia-cudnn-cu12==9.11.0.98
 + nvidia-cufft-cu12==11.4.1.4
 + nvidia-cusolver-cu12==11.7.5.82
 + nvidia-cusparse-cu12==12.5.10.65
 + nvidia-nccl-cu12==2.27.6
 + nvidia-nvjitlink-cu12==12.9.86
 + nvidia-nvshmem-cu12==3.3.9
 + opt-einsum==3.4.0
 + scipy==1.16.0
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ uv pip install flax tqdm matplotlib libigl gpytoolbox ipywidgets meshplot pythreejs
Using Python 3.13.5 environment at: GeoSPSR_uv
  × No solution found when resolving dependencies:
  ╰─▶ Because meshplot was not found in the package registry and you require meshplot, we can conclude that your requirements are unsatisfiable.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ uv pip install flax tqdm trimesh matplotlib libigl gpytoolbox ipywidgets pythreejs 'git+https://github.com/skoch9/meshplot.git'
Using Python 3.13.5 environment at: GeoSPSR_uv
    Updated https://github.com/skoch9/meshplot.git (725e4a7926a5f10888f0edd1762fecf9db751c56)
Resolved 73 packages in 3.35s
      Built meshplot @ git+https://github.com/skoch9/meshplot.git@725e4a7926a5f10888f0edd1762fecf9db751c56
Prepared 68 packages in 8.89s
Uninstalled 2 packages in 53ms
Installed 69 packages in 255ms
 + absl-py==2.3.1
 + asttokens==3.0.0
 + chex==0.1.89
 + comm==0.2.2
 + contourpy==1.3.2
 + cycler==0.12.1
 + decorator==5.2.1
 + etils==1.13.0
 + executing==2.2.0
 + flax==0.10.7
 + fonttools==4.59.0
 + fsspec==2025.7.0
 + gpytoolbox==0.3.6
 + humanize==4.12.3
 + imageio==2.37.0
 + importlib-resources==6.5.2
 + ipydatawidgets==4.3.5
 + ipython==9.4.0
 + ipython-pygments-lexers==1.1.1
 + ipywidgets==8.1.7
 + jedi==0.19.2
 + jupyterlab-widgets==3.0.15
 + kiwisolver==1.4.8
 + lazy-loader==0.4
 + libigl==2.6.1
 + markdown-it-py==3.0.0
 + matplotlib==3.10.3
 + matplotlib-inline==0.1.7
 + mdurl==0.1.2
 + meshplot==0.3.3 (from git+https://github.com/skoch9/meshplot.git@725e4a7926a5f10888f0edd1762fecf9db751c56)
 + msgpack==1.1.1
 + nest-asyncio==1.6.0
 + networkx==3.5
 - numpy==2.3.1
 + numpy==2.2.6
 + optax==0.2.5
 + orbax-checkpoint==0.11.19
 + packaging==25.0
 + parso==0.8.4
 + pexpect==4.9.0
 + pillow==11.3.0
 + prompt-toolkit==3.0.51
 + protobuf==6.31.1
 + ptyprocess==0.7.0
 + pure-eval==0.2.3
 + pygments==2.19.2
 + pyparsing==3.2.3
 + python-dateutil==2.9.0.post0
 + pythreejs==2.4.2
 + pyyaml==6.0.2
 + rich==14.0.0
 + scikit-image==0.25.2
 - scipy==1.16.0
 + scipy==1.15.0
 + scs==3.2.7.post2
 + setuptools==80.9.0
 + simplejson==3.20.1
 + six==1.17.0
 + stack-data==0.6.3
 + tensorstore==0.1.76
 + tifffile==2025.6.11
 + toolz==1.0.0
 + tqdm==4.67.1
 + traitlets==5.14.3
 + traittypes==0.2.1
 + treescope==0.1.9
 + trimesh==4.7.1
 + typing-extensions==4.14.1
 + wcwidth==0.2.13
 + widgetsnbextension==4.0.14
 + zipp==3.23.0
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ python -c "import meshplot; print('meshplot OK')"

meshplot OK
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ python /mnt/h/Hands-on_AI_based_3D_Vision/Project_11/GeoSPSR_uv/GeoSPSR_uv/Scripts>pip3.exe
/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/bin/python: can't find '__main__' module in '/mnt/h/Hands-on_AI_based_3D_Vision/Project_11/GeoSPSR_uv/GeoSPSR_uv/Scripts'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ PYTHONPATH=/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/build/lib
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ python /mnt/h/Hands-on_AI_based_3D_Vision/Project_11/GeoSPSR_uv/GeoSPSR_uv/Scripts>pip3.exe
/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/bin/python: can't find '__main__' module in '/mnt/h/Hands-on_AI_based_3D_Vision/Project_11/GeoSPSR_uv/GeoSPSR_uv/Scripts'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ ls
0.4.35  GeoSPSR_uv  README.md  build  experiments  geospsr.egg-info  pip3.exe  setup.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ cd build/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build$ ls
lib
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build$ cd lib/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib$ ls
geospsr  geospsr.egg-info
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib$ cd geospsr
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ ls
__init__.py  __pycache__  gp.py  kernels.py  sdd.py  utils.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ conda envs list
usage: conda [-h] [-v] [--no-plugins] [-V] COMMAND ...
conda: error: argument COMMAND: invalid choice: 'envs' (choose from activate, clean, commands, compare, config, content-trust, create, deactivate, doctor, env, export, info, init, install, list, notices, package, remove, rename, repoquery, run, search, tos, uninstall, update, upgrade)
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ conda env list

# conda environments:
#
                       /home/user/HandsOnProject_11/deep-geometric-prior/y
base                   /home/user/miniconda3
GeoSPSR                /home/user/miniconda3/envs/GeoSPSR
dgp                    /home/user/miniconda3/envs/dgp
dgp_new                /home/user/miniconda3/envs/dgp_new

(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ ls
GeoSPSR  README.md
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11$ ls
HandsOn_Project_11  deep-geometric-prior
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11$ cd HandsOn_Project_11/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ ls
GeoSPSR  README.md
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ cd GeoSPSR/q
bash: cd: GeoSPSR/q: No such file or directory
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ cd GeoSPSR
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ ls
0.4.35  GeoSPSR_uv  README.md  build  experiments  geospsr.egg-info  pip3.exe  setup.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11$ cd ..
(GeoSPSR_uv) user@KirianPC:~$ ls
HandsOnProject_11  cuda-repo-wsl-ubuntu-12-9-local_12.9.0-1_amd64.deb  gsplat  gsplat-env  miniconda3
(GeoSPSR_uv) user@KirianPC:~$ cd HandsOnProject_11/HandsOn_Project_11/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ ls
GeoSPSR  README.md
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ cd GeoSPSR/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ ls
0.4.35  GeoSPSR_uv  README.md  build  experiments  geospsr.egg-info  pip3.exe  setup.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ cd GeoSPSR_uv/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ ls
CACHEDIR.TAG  bin  etc  lib  lib64  pyvenv.cfg  share
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ cd lib
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib$ ls
python3.13
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib$ cd
(GeoSPSR_uv) user@KirianPC:~$ cd HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib$ ls
python3.13
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ ls
CACHEDIR.TAG  bin  etc  lib  lib64  pyvenv.cfg  share
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ ls
CACHEDIR.TAG  bin  etc  lib  lib64  pyvenv.cfg  share
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py
/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py:46: SyntaxWarning: invalid escape sequence '\H'
  v, _, _, f, _, _ = igl.readOBJ("H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj")
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py", line 41, in <module>
    from geospsr.kernels import Matern32Kernel, ProductKernel
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/kernels.py", line 8, in <module>
    class AbstractKernel(nnx.Module):
                         ^^^
NameError: name 'nnx' is not defined. Did you mean: 'nn'?
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ uv pip install 'git+https://github.com/google/flax.git'
Using Python 3.13.5 environment at:
    Updated https://github.com/google/flax.git (97f4a499a12f3b5d4aad8df60f450924bd2f94ee)
Resolved 30 packages in 4.16s
      Built flax @ git+https://github.com/google/flax.git@97f4a499a12f3b5d4aad8df60f450924bd2f94ee
Prepared 1 package in 372ms
Uninstalled 1 package in 9ms
Installed 1 package in 10ms
 - flax==0.10.7
 + flax==0.10.7 (from git+https://github.com/google/flax.git@97f4a499a12f3b5d4aad8df60f450924bd2f94ee)
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py
/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py:46: SyntaxWarning: invalid escape sequence '\H'
  v, _, _, f, _, _ = igl.readOBJ("H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj")
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py", line 41, in <module>
    from geospsr.kernels import Matern32Kernel, ProductKernel
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/kernels.py", line 8, in <module>
    class AbstractKernel(nnx.Module):
                         ^^^
NameError: name 'nnx' is not defined. Did you mean: 'nn'?
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py
/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py:46: SyntaxWarning: invalid escape sequence '\H'
  v, _, _, f, _, _ = igl.readOBJ("H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj")
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py", line 41, in <module>
    from geospsr.kernels import Matern32Kernel, ProductKernel
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/kernels.py", line 8, in <module>
    class AbstractKernel(nnx.Module):
                         ^^^
NameError: name 'nnx' is not defined. Did you mean: 'nn'?
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ nano /HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ nano /HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/kernels.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ nano /HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ cd  /HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib
bash: cd: /HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib: No such file or directory
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ cd  ~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib$ ls
geospsr  geospsr.egg-info
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib$ cd geospsr
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ ls
__init__.py  __pycache__  gp.py  kernels.py  sdd.py  utils.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ nano kernels.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ nano kernels.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ nano kernels.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py
/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py:46: SyntaxWarning: invalid escape sequence '\H'
  v, _, _, f, _, _ = igl.readOBJ("H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj")
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
IOError: H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj could not be opened...
Traceback (most recent call last):
<unknown>:2: SyntaxWarning: invalid escape sequence '\H'
<unknown>:1: SyntaxWarning: invalid escape sequence '\H'
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py", line 46, in <module>
    v, _, _, f, _, _ = igl.readOBJ("H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj")
                       ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Failed to read mesh from: H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py
/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py:46: SyntaxWarning: invalid escape sequence '\H'
  v, _, _, f, _, _ = igl.readOBJ("H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj")
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
IOError: H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj could not be opened...
Traceback (most recent call last):
<unknown>:2: SyntaxWarning: invalid escape sequence '\H'
<unknown>:1: SyntaxWarning: invalid escape sequence '\H'
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example.py", line 46, in <module>
    v, _, _, f, _, _ = igl.readOBJ("H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj")
                       ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Failed to read mesh from: H:\Hands-on_AI_based_3D_Vision\HandsOn_Project_11\GeoSPSR\experiments\meshes\scorpion.obj
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py:52: SyntaxWarning: invalid escape sequence '\m'
  v, _, _, f, _, _ = igl.readOBJ("/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments\meshes\scorpion.obj")
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
[CudaDevice(id=0)]
IOError: /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments\meshes\scorpion.obj could not be opened...
Traceback (most recent call last):
<unknown>:2: SyntaxWarning: invalid escape sequence '\m'
<unknown>:1: SyntaxWarning: invalid escape sequence '\m'
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 52, in <module>
    v, _, _, f, _, _ = igl.readOBJ("/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments\meshes\scorpion.obj")
                       ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Failed to read mesh from: /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments\meshes\scorpion.obj
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
[CudaDevice(id=0)]
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 72, in <module>
    plot_mesh_cloud_grid((v, f), (p, n), (x_grid, f_grid))
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/utils.py", line 156, in plot_mesh_cloud_grid
    plot = plot_mesh(v, f)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot/plot.py", line 94, in plot
    display(view._renderer)
    ^^^^^^^
NameError: name 'display' is not defined
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ cd ..
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ ls
GeoSPSR  README.md
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11$ cd GeoSPSR/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ ls
0.4.35  GeoSPSR_uv  README.md  build  experiments  geospsr.egg-info  pip3.exe  setup.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR$ cd GeoSPSR_uv/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ ls
CACHEDIR.TAG  bin  etc  lib  lib64  pyvenv.cfg  share
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv$ cd lib
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib$ ls
python3.13
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib$ cd python3.13/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13$ ls
site-packages
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13$ cd site-packages/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages$ cd m
markdown_it/                       matplotlib_inline/                 meshplot/                          ml_dtypes.libs/
markdown_it_py-3.0.0.dist-info/    matplotlib_inline-0.1.7.dist-info/ meshplot-0.3.3.dist-info/          mpl_toolkits/
matplotlib/                        mdurl/                             ml_dtypes/                         msgpack/
matplotlib-3.10.3.dist-info/       mdurl-0.1.2.dist-info/             ml_dtypes-0.5.1.dist-info/         msgpack-1.1.1.dist-info/
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages$ cd meshplot
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ nano plot.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
[CudaDevice(id=0)]
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 43.92it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.39it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.55it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.98s/it]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 117, in <module>
    plot_mean("output_pngs/cholesky_mean.png", x1_grid, x2_grid, f_cholesky, save=True)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/utils.py", line 138, in plot_mean
    plt.savefig(name, bbox_inches="tight", pad_inches=0, dpi=400)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/matplotlib/pyplot.py", line 1251, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/matplotlib/figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/matplotlib/backend_bases.py", line 2184, in print_figure
    result = print_method(
        filename,
    ...<3 lines>...
        bbox_inches_restore=_bbox_inches_restore,
        **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/matplotlib/backend_bases.py", line 2040, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ~~~~^
        *args, **{k: v for k, v in kwargs.items() if k not in skip}))
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/matplotlib/backends/backend_agg.py", line 481, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/matplotlib/backends/backend_agg.py", line 430, in _print_pil
    mpl.image.imsave(
    ~~~~~~~~~~~~~~~~^
        filename_or_obj, self.buffer_rgba(), format=fmt, origin="upper",
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dpi=self.figure.dpi, metadata=metadata, pil_kwargs=pil_kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/matplotlib/image.py", line 1657, in imsave
    image.save(fname, **pil_kwargs)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/PIL/Image.py", line 2583, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'output_pngs/cholesky_mean.png'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ nano plot.py
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
[CudaDevice(id=0)]
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 43.06it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.50it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.74it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.62s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 568.88it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.07it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 809.95it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.62it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:04<00:00, 237.06it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.44s/it]Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:00<?, ?it/s]2025-07-23 16:06:31.232463: E external/xla/xla/service/gpu/gpu_hlo_schedule.cc:813] The byte size of input/output arguments (9495254016) exceeds the base limit (8052572160). This indicates an error in the calculation!
2025-07-23 16:06:31.232594: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 0B (0 bytes) by rematerialization; only reduced to 2.95GiB (3165084672 bytes), down from 2.95GiB (3165084672 bytes) originally
2025-07-23 16:06:41.256438: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.95GiB (rounded to 3165084672)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 16:06:41.256545: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] ******___********************************************************************************___________
E0723 16:06:41.256570    3373 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes. [tf-allocator-allocation-error='']
Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:10<?, ?it/s]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 160, in <module>
    samples = sample_pathwise_conditioning(
        x_grid,
    ...<14 lines>...
        verbose=True,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 281, in sample_pathwise_conditioning
    v_prior = bmap(vs, x_data, bs_v, verbose, "Computing prior V samples").transpose(
              ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 276, in vs
    return vmap(
           ~~~~~
        vmap(evaluate_karhunen_loeve_sample, (None, None, None, 0)),
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        (None, None, None, 0),
        ~~~~~~~~~~~~~~~~~~~~~~
    )(x, v_eigenvectors, v_eigenvalues, xi)
    ~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 80, in evaluate_karhunen_loeve_sample
    return (eigenvalues * (cos_term + sin_term)).sum()
                           ~~~~~~~~~^~~~~~~~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
[CudaDevice(id=0)]
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 42.28it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.48it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.63it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.73s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 530.61it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.10it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 800.78it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.64it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:04<00:00, 246.19it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.27s/it]Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:00<?, ?it/s]2025-07-23 16:11:30.049261: E external/xla/xla/service/gpu/gpu_hlo_schedule.cc:813] The byte size of input/output arguments (9495254016) exceeds the base limit (8052572160). This indicates an error in the calculation!
2025-07-23 16:11:30.049392: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 0B (0 bytes) by rematerialization; only reduced to 2.95GiB (3165084672 bytes), down from 2.95GiB (3165084672 bytes) originally
2025-07-23 16:11:40.073060: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.95GiB (rounded to 3165084672)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 16:11:40.073170: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] ******___********************************************************************************___________
E0723 16:11:40.073198    3814 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes. [tf-allocator-allocation-error='']
Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:10<?, ?it/s]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 160, in <module>
    samples = sample_pathwise_conditioning(
        x_grid,
    ...<14 lines>...
        verbose=True,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 281, in sample_pathwise_conditioning
    v_prior = bmap(vs, x_data, bs_v, verbose, "Computing prior V samples").transpose(
              ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 276, in vs
    return vmap(
           ~~~~~
        vmap(evaluate_karhunen_loeve_sample, (None, None, None, 0)),
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        (None, None, None, 0),
        ~~~~~~~~~~~~~~~~~~~~~~
    )(x, v_eigenvectors, v_eigenvalues, xi)
    ~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 80, in evaluate_karhunen_loeve_sample
    return (eigenvalues * (cos_term + sin_term)).sum()
                           ~~~~~~~~~^~~~~~~~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
[CudaDevice(id=0)]
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 43.74it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.52it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.50it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.77s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 519.16it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.10it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 818.67it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.63it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:05<00:00, 193.37it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.43s/it]Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:00<?, ?it/s]2025-07-23 16:15:28.698054: E external/xla/xla/service/gpu/gpu_hlo_schedule.cc:813] The byte size of input/output arguments (9495254016) exceeds the base limit (8052572160). This indicates an error in the calculation!
2025-07-23 16:15:28.698183: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 0B (0 bytes) by rematerialization; only reduced to 2.95GiB (3165084672 bytes), down from 2.95GiB (3165084672 bytes) originally
2025-07-23 16:15:38.721622: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.95GiB (rounded to 3165084672)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 16:15:38.721732: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] ******___********************************************************************************___________
E0723 16:15:38.721760    4255 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes. [tf-allocator-allocation-error='']
Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:10<?, ?it/s]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 160, in <module>
    samples = sample_pathwise_conditioning(
        x_grid,
    ...<14 lines>...
        verbose=True,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 281, in sample_pathwise_conditioning
    v_prior = bmap(vs, x_data, bs_v, verbose, "Computing prior V samples").transpose(
              ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 276, in vs
    return vmap(
           ~~~~~
        vmap(evaluate_karhunen_loeve_sample, (None, None, None, 0)),
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        (None, None, None, 0),
        ~~~~~~~~~~~~~~~~~~~~~~
    )(x, v_eigenvectors, v_eigenvalues, xi)
    ~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 80, in evaluate_karhunen_loeve_sample
    return (eigenvalues * (cos_term + sin_term)).sum()
                           ~~~~~~~~~^~~~~~~~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
[CudaDevice(id=0)]
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:21<00:00, 44.86it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.50it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.63it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.78s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 542.29it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.35s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 832.13it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.60it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:04<00:00, 229.73it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.56s/it]Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:00<?, ?it/s]2025-07-23 16:21:02.130045: E external/xla/xla/service/gpu/gpu_hlo_schedule.cc:813] The byte size of input/output arguments (9495254016) exceeds the base limit (8052572160). This indicates an error in the calculation!
2025-07-23 16:21:02.130165: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 0B (0 bytes) by rematerialization; only reduced to 2.95GiB (3165084672 bytes), down from 2.95GiB (3165084672 bytes) originally
2025-07-23 16:21:12.152519: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.95GiB (rounded to 3165084672)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 16:21:12.152633: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] ******___********************************************************************************___________
E0723 16:21:12.152660    4699 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes. [tf-allocator-allocation-error='']
Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:10<?, ?it/s]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 161, in <module>
    samples = sample_pathwise_conditioning(
        x_grid,
    ...<14 lines>...
        verbose=True,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 281, in sample_pathwise_conditioning
    v_prior = bmap(vs, x_data, bs_v, verbose, "Computing prior V samples").transpose(
              ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 276, in vs
    return vmap(
           ~~~~~
        vmap(evaluate_karhunen_loeve_sample, (None, None, None, 0)),
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        (None, None, None, 0),
        ~~~~~~~~~~~~~~~~~~~~~~
    )(x, v_eigenvectors, v_eigenvalues, xi)
    ~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 80, in evaluate_karhunen_loeve_sample
    return (eigenvalues * (cos_term + sin_term)).sum()
                           ~~~~~~~~~^~~~~~~~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
[CudaDevice(id=0)]
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 41.52it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.63it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.71it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.72s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 474.74it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.11it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 762.11it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.67it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 374.70it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.81s/it]Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:00<?, ?it/s]2025-07-23 16:22:56.296362: E external/xla/xla/service/gpu/gpu_hlo_schedule.cc:813] The byte size of input/output arguments (9495254016) exceeds the base limit (8052572160). This indicates an error in the calculation!
2025-07-23 16:22:56.296492: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 0B (0 bytes) by rematerialization; only reduced to 2.95GiB (3165084672 bytes), down from 2.95GiB (3165084672 bytes) originally
2025-07-23 16:23:06.611631: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.95GiB (rounded to 3165084672)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 16:23:06.611794: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] ******___********************************************************************************___________
E0723 16:23:06.611835    5140 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes. [tf-allocator-allocation-error='']
Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:10<?, ?it/s]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 161, in <module>
    samples = sample_pathwise_conditioning(
        x_grid,
    ...<14 lines>...
        verbose=True,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 281, in sample_pathwise_conditioning
    v_prior = bmap(vs, x_data, bs_v, verbose, "Computing prior V samples").transpose(
              ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 276, in vs
    return vmap(
           ~~~~~
        vmap(evaluate_karhunen_loeve_sample, (None, None, None, 0)),
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        (None, None, None, 0),
        ~~~~~~~~~~~~~~~~~~~~~~
    )(x, v_eigenvectors, v_eigenvalues, xi)
    ~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 80, in evaluate_karhunen_loeve_sample
    return (eigenvalues * (cos_term + sin_term)).sum()
                           ~~~~~~~~~^~~~~~~~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CpuDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator:   7%|███████▎                                                                                                       | 64/977 [02:44<38:43,  2.54s/it]Creating interpolator:   7%|███████▎                                                                                                       | 64/977 [02:47<39:43,  2.61s/it]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 94, in <module>
    k_fv = periodic_stationary_interpolator(
        k_fv_expensive, 3, amortization_density, exponent=5, verbose=True
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 59, in periodic_stationary_interpolator
    f_interpolator = interpolator(f, (xis,) * dim, bs, verbose)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 44, in interpolator
    values = bmap(
             ~~~~^
        f, grid.reshape(-1, dim), bs, verbose, desc="Creating interpolator"
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ).reshape(*grid.shape[:-1], -1)
    ^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 24, in poisson_cross_covariances
    return (eigenvectors.T * eigenvalues**2 * sin / evec_norm_sq).sum(-1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 260, in cache_miss
    _python_pjit_helper(fun, jit_info, *args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 149, in _python_pjit_helper
    out_flat = jit_p.bind(*args_flat, **p.params)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 1126, in process_primitive
    return primitive.impl(*args, **params)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1821, in _pjit_call_impl
    return xc._xla.pjit(
           ~~~~~~~~~~~~~
        name, f, call_impl_cache_miss, [], [], cache_key,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        tree_util.dispatch_registry, pxla.cc_shard_arg,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        _get_cpp_global_cache(cache_key.contains_explicit_attributes))(*args)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
KeyboardInterrupt
^C
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$   export TF_GPU_ALLOCATOR=cuda_malloc_async
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 42.65it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.51it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.64it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.68s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 541.12it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.11it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 810.62it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.60it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 390.17it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.71s/it]Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:00<?, ?it/s]2025-07-23 16:27:14.685963: E external/xla/xla/service/gpu/gpu_hlo_schedule.cc:813] The byte size of input/output arguments (9495254016) exceeds the base limit (8052572160). This indicates an error in the calculation!
2025-07-23 16:27:14.686092: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 0B (0 bytes) by rematerialization; only reduced to 2.95GiB (3165084672 bytes), down from 2.95GiB (3165084672 bytes) originally
2025-07-23 16:27:24.710163: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.95GiB (rounded to 3165084672)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 16:27:24.710274: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] ******___********************************************************************************___________
E0723 16:27:24.710307    5690 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes. [tf-allocator-allocation-error='']
Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:10<?, ?it/s]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 162, in <module>
    samples = sample_pathwise_conditioning(
        x_grid,
    ...<14 lines>...
        verbose=True,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 281, in sample_pathwise_conditioning
    v_prior = bmap(vs, x_data, bs_v, verbose, "Computing prior V samples").transpose(
              ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 276, in vs
    return vmap(
           ~~~~~
        vmap(evaluate_karhunen_loeve_sample, (None, None, None, 0)),
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        (None, None, None, 0),
        ~~~~~~~~~~~~~~~~~~~~~~
    )(x, v_eigenvectors, v_eigenvalues, xi)
    ~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 80, in evaluate_karhunen_loeve_sample
    return (eigenvalues * (cos_term + sin_term)).sum()
                           ~~~~~~~~~^~~~~~~~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$   export JAX_TRACEBACK_FILTERING=off
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 43.91it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.48it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.62it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.71s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 549.52it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.13it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 821.40it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.66it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 393.71it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.70s/it]Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:00<?, ?it/s]2025-07-23 16:28:26.730636: E external/xla/xla/service/gpu/gpu_hlo_schedule.cc:813] The byte size of input/output arguments (9495254016) exceeds the base limit (8052572160). This indicates an error in the calculation!
2025-07-23 16:28:26.730766: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 0B (0 bytes) by rematerialization; only reduced to 2.95GiB (3165084672 bytes), down from 2.95GiB (3165084672 bytes) originally
2025-07-23 16:28:37.183830: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.95GiB (rounded to 3165084672)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 16:28:37.183969: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] ******___********************************************************************************___________
E0723 16:28:37.184007    6131 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes. [tf-allocator-allocation-error='']
Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:10<?, ?it/s]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 162, in <module>
    samples = sample_pathwise_conditioning(
        x_grid,
    ...<14 lines>...
        verbose=True,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 281, in sample_pathwise_conditioning
    v_prior = bmap(vs, x_data, bs_v, verbose, "Computing prior V samples").transpose(
              ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 276, in vs
    return vmap(
           ~~~~~
        vmap(evaluate_karhunen_loeve_sample, (None, None, None, 0)),
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        (None, None, None, 0),
        ~~~~~~~~~~~~~~~~~~~~~~
    )(x, v_eigenvectors, v_eigenvalues, xi)
    ~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 80, in evaluate_karhunen_loeve_sample
    return (eigenvalues * (cos_term + sin_term)).sum()
                           ~~~~~~~~~^~~~~~~~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 260, in cache_miss
    _python_pjit_helper(fun, jit_info, *args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 149, in _python_pjit_helper
    out_flat = jit_p.bind(*args_flat, **p.params)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 1126, in process_primitive
    return primitive.impl(*args, **params)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1821, in _pjit_call_impl
    return xc._xla.pjit(
           ~~~~~~~~~~~~~
        name, f, call_impl_cache_miss, [], [], cache_key,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        tree_util.dispatch_registry, pxla.cc_shard_arg,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        _get_cpp_global_cache(cache_key.contains_explicit_attributes))(*args)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1798, in call_impl_cache_miss
    out_flat, compiled, pgle_profiler = _pjit_call_impl_python(
                                        ~~~~~~~~~~~~~~~~~~~~~~^
        *args, jaxpr=jaxpr, in_shardings=in_shardings,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        ctx_mesh=ctx_mesh, name=name, keep_unused=keep_unused,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        inline=inline, compiler_options_kvs=compiler_options_kvs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1777, in _pjit_call_impl_python
    return compiled.unsafe_call(*args), compiled, pgle_profiler
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/profiler.py", line 354, in wrapper
    return func(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/pxla.py", line 1305, in __call__
    results = self.xla_executable.execute_sharded(input_bufs)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:21<00:00, 45.26it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.52it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.65it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.70s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 552.01it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.16it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 836.35it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.67it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 393.05it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:03<00:00,  3.52s/it]Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:00<?, ?it/s]2025-07-23 16:35:33.715732: E external/xla/xla/service/gpu/gpu_hlo_schedule.cc:813] The byte size of input/output arguments (9495254016) exceeds the base limit (8052572160). This indicates an error in the calculation!
2025-07-23 16:35:33.715868: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 0B (0 bytes) by rematerialization; only reduced to 2.95GiB (3165084672 bytes), down from 2.95GiB (3165084672 bytes) originally
2025-07-23 16:35:43.740548: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.95GiB (rounded to 3165084672)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 16:35:43.740661: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] ******___********************************************************************************___________
E0723 16:35:43.740689    6572 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes. [tf-allocator-allocation-error='']
Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:10<?, ?it/s]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 164, in <module>
    samples = sample_pathwise_conditioning(
        x_grid,
    ...<14 lines>...
        verbose=True,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 281, in sample_pathwise_conditioning
    v_prior = bmap(vs, x_data, bs_v, verbose, "Computing prior V samples").transpose(
              ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 276, in vs
    return vmap(
           ~~~~~
        vmap(evaluate_karhunen_loeve_sample, (None, None, None, 0)),
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        (None, None, None, 0),
        ~~~~~~~~~~~~~~~~~~~~~~
    )(x, v_eigenvectors, v_eigenvalues, xi)
    ~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 80, in evaluate_karhunen_loeve_sample
    return (eigenvalues * (cos_term + sin_term)).sum()
                           ~~~~~~~~~^~~~~~~~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 260, in cache_miss
    _python_pjit_helper(fun, jit_info, *args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 149, in _python_pjit_helper
    out_flat = jit_p.bind(*args_flat, **p.params)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 1126, in process_primitive
    return primitive.impl(*args, **params)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1821, in _pjit_call_impl
    return xc._xla.pjit(
           ~~~~~~~~~~~~~
        name, f, call_impl_cache_miss, [], [], cache_key,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        tree_util.dispatch_registry, pxla.cc_shard_arg,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        _get_cpp_global_cache(cache_key.contains_explicit_attributes))(*args)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1798, in call_impl_cache_miss
    out_flat, compiled, pgle_profiler = _pjit_call_impl_python(
                                        ~~~~~~~~~~~~~~~~~~~~~~^
        *args, jaxpr=jaxpr, in_shardings=in_shardings,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        ctx_mesh=ctx_mesh, name=name, keep_unused=keep_unused,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        inline=inline, compiler_options_kvs=compiler_options_kvs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1777, in _pjit_call_impl_python
    return compiled.unsafe_call(*args), compiled, pgle_profiler
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/profiler.py", line 354, in wrapper
    return func(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/pxla.py", line 1305, in __call__
    results = self.xla_executable.execute_sharded(input_bufs)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 42.94it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.53it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.72it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.67s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 560.32it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.10it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 829.02it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.67it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 384.73it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.74s/it]x_grid = jax.device_put(x_grid, device=jax.devices('cpu')[0])
Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:00<?, ?it/s]2025-07-23 16:39:42.361978: E external/xla/xla/service/gpu/gpu_hlo_schedule.cc:813] The byte size of input/output arguments (9495254016) exceeds the base limit (8052572160). This indicates an error in the calculation!
2025-07-23 16:39:42.362123: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 0B (0 bytes) by rematerialization; only reduced to 2.95GiB (3165084672 bytes), down from 2.95GiB (3165084672 bytes) originally
2025-07-23 16:39:52.385750: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.95GiB (rounded to 3165084672)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 16:39:52.385856: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] ******___********************************************************************************___________
E0723 16:39:52.385883    7013 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes. [tf-allocator-allocation-error='']
Computing prior V samples:   0%|                                                                                                                     | 0/11 [00:10<?, ?it/s]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 164, in <module>
    samples = sample_pathwise_conditioning(
        x_grid,
    ...<14 lines>...
        verbose=True,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 281, in sample_pathwise_conditioning
    v_prior = bmap(vs, x_data, bs_v, verbose, "Computing prior V samples").transpose(
              ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 276, in vs
    return vmap(
           ~~~~~
        vmap(evaluate_karhunen_loeve_sample, (None, None, None, 0)),
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        (None, None, None, 0),
        ~~~~~~~~~~~~~~~~~~~~~~
    )(x, v_eigenvectors, v_eigenvalues, xi)
    ~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 80, in evaluate_karhunen_loeve_sample
    return (eigenvalues * (cos_term + sin_term)).sum()
                           ~~~~~~~~~^~~~~~~~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 260, in cache_miss
    _python_pjit_helper(fun, jit_info, *args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 149, in _python_pjit_helper
    out_flat = jit_p.bind(*args_flat, **p.params)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 1126, in process_primitive
    return primitive.impl(*args, **params)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1821, in _pjit_call_impl
    return xc._xla.pjit(
           ~~~~~~~~~~~~~
        name, f, call_impl_cache_miss, [], [], cache_key,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        tree_util.dispatch_registry, pxla.cc_shard_arg,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        _get_cpp_global_cache(cache_key.contains_explicit_attributes))(*args)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1798, in call_impl_cache_miss
    out_flat, compiled, pgle_profiler = _pjit_call_impl_python(
                                        ~~~~~~~~~~~~~~~~~~~~~~^
        *args, jaxpr=jaxpr, in_shardings=in_shardings,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        ctx_mesh=ctx_mesh, name=name, keep_unused=keep_unused,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        inline=inline, compiler_options_kvs=compiler_options_kvs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1777, in _pjit_call_impl_python
    return compiled.unsafe_call(*args), compiled, pgle_profiler
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/profiler.py", line 354, in wrapper
    return func(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/pxla.py", line 1305, in __call__
    results = self.xla_executable.execute_sharded(input_bufs)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 3165084672 bytes.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:21<00:00, 46.21it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.52it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.64it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.69s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 544.87it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.10it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 448.62it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.62it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 380.49it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.78s/it]Size of x_data: 8292 bytes
Size of v_data: 8292 bytes
Size of xi: 98908896 bytes
Size of gamma: 32969632 bytes
x_grid = jax.device_put(x_grid, device=jax.devices('cpu')[0])
Computing prior V samples: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [01:03<00:00,  5.73s/it]Computing f update: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:07<00:00,  5.48it/s]Computing prior f samples: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [01:41<00:00,  2.53s/it]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 209, in <module>
    mesh = trimesh.Trimesh(vertices=vertices_with_height, faces=faces)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/trimesh/base.py", line 225, in __init__
    self.process(validate=validate, merge_tex=merge_tex, merge_norm=merge_norm)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/trimesh/base.py", line 276, in process
    self.merge_vertices(merge_tex=merge_tex, merge_norm=merge_norm)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/trimesh/base.py", line 1146, in merge_vertices
    grouping.merge_vertices(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        mesh=self,
        ^^^^^^^^^^
    ...<4 lines>...
        digits_uv=digits_uv,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/trimesh/grouping.py", line 72, in merge_vertices
    referenced[mesh.faces] = True
    ~~~~~~~~~~^^^^^^^^^^^^
IndexError: index 2501 is out of bounds for axis 0 with size 2500
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:21<00:00, 45.01it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.57it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.64it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.75s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 550.87it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.11it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 452.70it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.63it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:04<00:00, 237.07it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.43s/it]Size of x_data: 8292 bytes
Size of v_data: 8292 bytes
Size of xi: 98908896 bytes
Size of gamma: 32969632 bytes
x_grid = jax.device_put(x_grid, device=jax.devices('cpu')[0])
Computing prior V samples: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [01:01<00:00,  5.59s/it]Computing f update: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [00:25<00:00,  6.13it/s]Computing prior f samples: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [06:24<00:00,  2.45s/it](GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ uv pip install MISE
Using Python 3.13.5 environment at: /home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv
  × No solution found when resolving dependencies:
  ╰─▶ Because there are no versions of mise and you require mise, we can conclude that your requirements are unsatisfiable.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ uv pip install skimage
Using Python 3.13.5 environment at: /home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv
  × Failed to build `skimage==0.0`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta:__legacy__.build_wheel` failed (exit status: 1)

      [stderr]

      *** Please install the `scikit-image` package (instead of `skimage`) ***


      hint: This usually indicates a problem with the package or the build environment.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ uv pip install scikit-image
Using Python 3.13.5 environment at: /home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv
Audited 1 package in 13ms
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ uv pip show scikit-image
Using Python 3.13.5 environment at: /home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv
Name: scikit-image
Version: 0.25.2
Location: /home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages
Requires: imageio, lazy-loader, networkx, numpy, packaging, pillow, scipy, tifffile
Required-by: gpytoolbox
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ uv pip show scikit-image
Using Python 3.13.5 environment at: /home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv
Name: scikit-image
Version: 0.25.2
Location: /home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages
Requires: imageio, lazy-loader, networkx, numpy, packaging, pillow, scipy, tifffile
Required-by: gpytoolbox
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:25<00:00, 38.16it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.25it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.60it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.73s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 572.40it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.25it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 681.28it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.52it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:03<00:00, 253.52it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.13s/it]Size of x_data: 8292 bytes
Size of v_data: 8292 bytes
Size of xi: 98908896 bytes
Size of gamma: 32969632 bytes
x_grid = jax.device_put(x_grid, device=jax.devices('cpu')[0])
Computing prior V samples: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [01:04<00:00,  5.86s/it]Computing f update: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [00:24<00:00,  6.51it/s]Computing prior f samples: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [06:44<00:00,  2.57s/it]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 264, in <module>
    extract_mesh(
    ~~~~~~~~~~~~^
        x_grid, x_data, v_data, k_v, k_fv, sigma,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        grid_res=100,  # Must match your x_grid generation
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_path=out_path("output_meshes", "gp_reconstructed_surface.ply")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 245, in extract_mesh
    f_grid = f_mean.reshape((grid_res, grid_res, grid_res))
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 316, in _reshape
    newshape = _compute_newshape(self, args[0] if len(args) == 1 else args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 477, in _compute_newshape
    raise TypeError(f"cannot reshape array of shape {arr.shape} (size {arr.size}) "
                    f"into shape {orig_newshape} (size {math.prod(newshape)})")
TypeError: cannot reshape array of shape (10000,) (size 10000) into shape (100, 100, 100) (size 1000000)
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 41.61it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.60it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.68it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.63s/it]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 580.70it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.31it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 894.01it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.77it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:03<00:00, 266.11it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:03<00:00,  3.97s/it]Shape of xi: (4, 3, 1030301, 2)
Shape of gamma: (4, 1030301, 2)
Shape of k_v_eigenvectors: (1030301, 3)
Shape of k_v_eigenvalues: (1030301,)
x_grid = jax.device_put(x_grid, device=jax.devices('cpu')[0])
Computing prior V samples: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [01:02<00:00,  5.67s/it]Computing f update: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [00:26<00:00,  5.93it/s]Computing prior f samples: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [06:33<00:00,  2.51s/it]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 286, in <module>
        return mesh
        ^^^^^^^^^^^
    ...<3 lines>...
        x_grid, x_data, v_data, k_v, k_fv, sigma,

  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 267, in extract_mesh
    )

  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 316, in _reshape
    newshape = _compute_newshape(self, args[0] if len(args) == 1 else args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 477, in _compute_newshape
    raise TypeError(f"cannot reshape array of shape {arr.shape} (size {arr.size}) "
                    f"into shape {orig_newshape} (size {math.prod(newshape)})")
TypeError: cannot reshape array of shape (10000,) (size 10000) into shape (100, 100, 100) (size 1000000)
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:24<00:00, 40.62it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.66it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.72it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.65s/it]Shape of f_cholesky: (10000,)
Shape of var_cholesky: (10000,)
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 580.85it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.29it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 857.79it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.71it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:03<00:00, 259.67it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.04s/it]Shape of f_sgd: (10000,)
Shape of var_sgd: (10000,)
Shape of xi: (4, 3, 1030301, 2)
Shape of gamma: (4, 1030301, 2)
Shape of k_v_eigenvectors: (1030301, 3)
Shape of k_v_eigenvalues: (1030301,)
x_grid = jax.device_put(x_grid, device=jax.devices('cpu')[0])
Computing prior V samples: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [01:05<00:00,  5.93s/it]Computing f update: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [00:26<00:00,  5.94it/s]Computing prior f samples:  80%|████████████████████████████████████████████████████████████████████████████████████▍                     | 125/157 [05:39<01:24,  2.65s/it]Computing prior f samples:  80%|████████████████████████████████████████████████████████████████████████████████████▍                     | 125/157 [05:40<01:27,  2.72s/it]Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 203, in <module>
    """print("x_grid = jax.device_put(x_grid, device=jax.devices('cpu')[0])")
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<16 lines>...
        verbose=True,

  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 316, in sample_pathwise_conditioning
    f_prior = bmap(fs, x_query, bs_f, verbose, "Computing prior f samples").transpose(
              ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 312, in fs
    return vmap(evaluate_karhunen_loeve_sample, (None, None, None, 0))(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        x, f_eigenvectors, f_eigenvalues, gamma
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 77, in evaluate_karhunen_loeve_sample
    cos_term = xi[:, 0] * jnp.cos(dot)
               ~~^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 660, in _getitem
    return indexing.rewriting_take(self, item)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/indexing.py", line 639, in rewriting_take
    result = _attempt_rewriting_take_via_slice(arr, idx, mode, out_sharding)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/indexing.py", line 602, in _attempt_rewriting_take_via_slice
    arr = slicing.slice(
        arr, start_indices=int_start_indices, limit_indices=int_limit_indices)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/slicing.py", line 111, in slice
    return slice_p.bind(operand, start_indices=tuple(start_indices),
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                        limit_indices=tuple(limit_indices),
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                        strides=None if strides is None else tuple(strides))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 531, in process_primitive
    val_out, dim_out = primitive_batchers[p](vals_in, dims_in, **params)
                       ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/slicing.py", line 1455, in _slice_batching_rule
    out = slice(operand, new_start_indices, new_limit_indices, new_strides)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/slicing.py", line 111, in slice
    return slice_p.bind(operand, start_indices=tuple(start_indices),
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                        limit_indices=tuple(limit_indices),
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                        strides=None if strides is None else tuple(strides))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 528, in process_primitive
    return p.bind_with_trace(self.parent_trace, vals_in, params)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 1126, in process_primitive
    return primitive.impl(*args, **params)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/slicing.py", line 1478, in _slice_impl
    return dispatch.apply_primitive(dynamic_slice_p, x, *start_indices,
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                    slice_sizes=slice_sizes)
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/dispatch.py", line 91, in apply_primitive
    outs = fun(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 260, in cache_miss
    _python_pjit_helper(fun, jit_info, *args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 149, in _python_pjit_helper
    out_flat = jit_p.bind(*args_flat, **p.params)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 1126, in process_primitive
    return primitive.impl(*args, **params)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1821, in _pjit_call_impl
    return xc._xla.pjit(
           ~~~~~~~~~~~~~
        name, f, call_impl_cache_miss, [], [], cache_key,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        tree_util.dispatch_registry, pxla.cc_shard_arg,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        _get_cpp_global_cache(cache_key.contains_explicit_attributes))(*args)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
KeyboardInterrupt
^C^C
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 41.14it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.66it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.69it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.72s/it]Shape of f_cholesky: (10000,)
Shape of var_cholesky: (10000,)
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 543.78it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.24it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 858.82it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.69it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:06<00:00, 143.54it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.16s/it]Shape of f_sgd: (10000,)
Shape of var_sgd: (10000,)
Shape of xi: (4, 3, 1030301, 2)
Shape of gamma: (4, 1030301, 2)
Shape of k_v_eigenvectors: (1030301, 3)
Shape of k_v_eigenvalues: (1030301,)
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 290, in <module>
    extract_mesh(
    ~~~~~~~~~~~~^
        x_grid, x_data, v_data, k_v, k_fv, sigma,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        grid_res=100,  # Must match your x_grid generation
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_path=out_path("output_meshes", "gp_reconstructed_surface.ply")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 271, in extract_mesh
    f_grid = f_mean.reshape((grid_res, grid_res, grid_res))
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 316, in _reshape
    newshape = _compute_newshape(self, args[0] if len(args) == 1 else args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 477, in _compute_newshape
    raise TypeError(f"cannot reshape array of shape {arr.shape} (size {arr.size}) "
                    f"into shape {orig_newshape} (size {math.prod(newshape)})")
TypeError: cannot reshape array of shape (10000,) (size 10000) into shape (100, 100, 100) (size 1000000)
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 294
    3D_grid, x_data, v_data, k_v, k_fv, sigma,
    ^
SyntaxError: invalid decimal literal
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 294
    3D_grid, x_data, v_data, k_v, k_fv, sigma,
    ^
SyntaxError: invalid decimal literal
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 41.69it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.67it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.73it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.67s/it]Shape of f_cholesky: (10000,)
Shape of var_cholesky: (10000,)
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 563.78it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.28it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 862.86it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.75it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:03<00:00, 265.27it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:03<00:00,  3.97s/it]Shape of f_sgd: (10000,)
Shape of var_sgd: (10000,)
Shape of xi: (4, 3, 1030301, 2)
Shape of gamma: (4, 1030301, 2)
Shape of k_v_eigenvectors: (1030301, 3)
Shape of k_v_eigenvalues: (1030301,)
Shape of grid_3D: (3, 20, 20, 20)
grid_3D
: [[[[-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   [-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   [-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   ...
   [-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   [-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   [-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]]

  [[-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   ...
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]]

  [[-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   ...
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]]

  ...

  [[ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   ...
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]]

  [[ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   ...
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]]

  [[ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]
   ...
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]]]


 [[[-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   ...
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]]

  [[-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   ...
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]]

  [[-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   ...
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]]

  ...

  [[-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   ...
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]]

  [[-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   ...
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]]

  [[-0.5        -0.5        -0.5        ... -0.5        -0.5
    -0.5       ]
   [-0.44736842 -0.44736842 -0.44736842 ... -0.44736842 -0.44736842
    -0.44736842]
   [-0.39473684 -0.39473684 -0.39473684 ... -0.39473684 -0.39473684
    -0.39473684]
   ...
   [ 0.39473684  0.39473684  0.39473684 ...  0.39473684  0.39473684
     0.39473684]
   [ 0.44736842  0.44736842  0.44736842 ...  0.44736842  0.44736842
     0.44736842]
   [ 0.5         0.5         0.5        ...  0.5         0.5
     0.5       ]]]


 [[[ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   ...
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]]

  [[ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   ...
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]]

  [[ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   ...
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]]

  ...

  [[ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   ...
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]]

  [[ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   ...
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]]

  [[ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   ...
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]
   [ 0.          0.02631579  0.05263158 ...  0.44736842  0.47368421
     0.5       ]]]]
Traceback (most recent call last):
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/lax.py", line 216, in _broadcast_shapes_uncached
    return _try_broadcast_shapes(*rank_promoted_shapes, name='broadcast_shapes')
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/lax.py", line 133, in _try_broadcast_shapes
    raise TypeError(f'{name} got incompatible shapes for broadcasting: '
                    f'{", ".join(map(str, map(tuple, shapes)))}.')
TypeError: broadcast_shapes got incompatible shapes for broadcasting: (20, 20, 20), (1, 1, 3).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/lax.py", line 194, in broadcast_shapes
    return _broadcast_shapes_cached(*shapes)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/util.py", line 298, in wrapper
    return cached(config.trace_context() if trace_context_in_key else _ignore(),
                  *args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/util.py", line 292, in cached
    return f(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/lax.py", line 200, in _broadcast_shapes_cached
    return _broadcast_shapes_uncached(*shapes)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/lax.py", line 219, in _broadcast_shapes_uncached
    raise ValueError(f"Incompatible shapes for broadcasting: shapes={list(shapes)}") from err
ValueError: Incompatible shapes for broadcasting: shapes=[(20, 20, 20), (3,)]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/lax.py", line 216, in _broadcast_shapes_uncached
    return _try_broadcast_shapes(*rank_promoted_shapes, name='broadcast_shapes')
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/lax.py", line 133, in _try_broadcast_shapes
    raise TypeError(f'{name} got incompatible shapes for broadcasting: '
                    f'{", ".join(map(str, map(tuple, shapes)))}.')
TypeError: broadcast_shapes got incompatible shapes for broadcasting: (20, 20, 20), (1, 1, 3).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 293, in <module>
    extract_mesh(
    ~~~~~~~~~~~~^
        grid_3D, x_data, v_data, k_v, k_fv, sigma,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        grid_res=grid_3D.shape[0],  # Must match your x_grid generation
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_path=out_path("output_meshes", "gp_reconstructed_surface.ply")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 266, in extract_mesh
    f_mean = compute_implicit_function_mean(
        x_grid, x_data, v_data, k_v, k_fv, sigma
    )
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 256, in compute_implicit_function_mean
    grid_mean = compute_mean(x_grid, x_data, v_data, k_v, k_fv, sigma)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 137, in compute_mean
    update_query = bmap(update, x_query, bs, verbose, "Computing mean")
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 260, in cache_miss
    _python_pjit_helper(fun, jit_info, *args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 137, in _python_pjit_helper
    p, args_flat = _infer_params(fun, jit_info, args, kwargs)
                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 629, in _infer_params
    return _infer_params_internal(fun, ji, args, kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 653, in _infer_params_internal
    p, args_flat = _infer_params_impl(
                   ~~~~~~~~~~~~~~~~~~^
        fun, ji, ctx_mesh, dbg, args, kwargs, in_avals=avals)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 552, in _infer_params_impl
    jaxpr, consts, jaxpr_for_top_jit, out_avals = _create_pjit_jaxpr(
                                                  ~~~~~~~~~~~~~~~~~~^
        flat_fun, in_type, IgnoreKey(ji.inline))
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 472, in memoized_fun
    ans = call(fun, *args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1350, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(fun, in_type)
                                      ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/profiler.py", line 354, in wrapper
    return func(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/partial_eval.py", line 2337, in trace_to_jaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api_util.py", line 73, in flatten_fun
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 133, in update
    return (kfv_row(x) * alpha).sum()
            ~~~~~~~^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 130, in kfv_row
    return vmap(kernel_fv, (None, 0))(x, x_data)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 62, in helper
    x_diff = x1 - x2
             ~~~^~~~
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 1125, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 586, in deferring_binary_op
    return binary_op(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 260, in cache_miss
    _python_pjit_helper(fun, jit_info, *args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 137, in _python_pjit_helper
    p, args_flat = _infer_params(fun, jit_info, args, kwargs)
                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 629, in _infer_params
    return _infer_params_internal(fun, ji, args, kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 653, in _infer_params_internal
    p, args_flat = _infer_params_impl(
                   ~~~~~~~~~~~~~~~~~~^
        fun, ji, ctx_mesh, dbg, args, kwargs, in_avals=avals)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 552, in _infer_params_impl
    jaxpr, consts, jaxpr_for_top_jit, out_avals = _create_pjit_jaxpr(
                                                  ~~~~~~~~~~~~~~~~~~^
        flat_fun, in_type, IgnoreKey(ji.inline))
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 472, in memoized_fun
    ans = call(fun, *args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1350, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(fun, in_type)
                                      ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/profiler.py", line 354, in wrapper
    return func(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/partial_eval.py", line 2337, in trace_to_jaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api_util.py", line 73, in flatten_fun
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/ufuncs.py", line 1568, in subtract
    out = lax.sub(*promote_args("subtract", x, y))
                   ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/util.py", line 229, in promote_args
    return promote_shapes(fun_name, *promote_dtypes(*args))
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/util.py", line 65, in promote_shapes
    result_rank = len(lax.broadcast_shapes(*shapes))
                      ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/lax.py", line 196, in broadcast_shapes
    return _broadcast_shapes_uncached(*shapes)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/lax/lax.py", line 219, in _broadcast_shapes_uncached
    raise ValueError(f"Incompatible shapes for broadcasting: shapes={list(shapes)}") from err
ValueError: Incompatible shapes for broadcasting: shapes=[(20, 20, 20), (3,)]
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:20<00:00, 47.05it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:03<00:00,  3.51s/it]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.70it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.67s/it]Shape of f_cholesky: (10000,)
Shape of var_cholesky: (10000,)
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 546.07it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.26it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 749.45it/s]Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.71it/s]SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:03<00:00, 255.62it/s]Computing variance: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.07s/it]Shape of f_sgd: (10000,)
Shape of var_sgd: (10000,)
Shape of xi: (4, 3, 1030301, 2)
Shape of gamma: (4, 1030301, 2)
Shape of k_v_eigenvectors: (1030301, 3)
Shape of k_v_eigenvalues: (1030301,)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.5         0.02631579]
 [-0.5        -0.5         0.05263158]
 ...
 [ 0.5         0.5         0.44736842]
 [ 0.5         0.5         0.47368421]
 [ 0.5         0.5         0.5       ]]
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 294, in <module>
    extract_mesh(
    ~~~~~~~~~~~~^
        grid_3D, x_data, v_data, k_v, k_fv, sigma,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        grid_res=grid_3D.shape[0],  # Must match your x_grid generation
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_path=out_path("output_meshes", "gp_reconstructed_surface.ply")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 271, in extract_mesh
    f_grid = f_mean.reshape((grid_res, grid_res, grid_res))
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 316, in _reshape
    newshape = _compute_newshape(self, args[0] if len(args) == 1 else args)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/numpy/array_methods.py", line 477, in _compute_newshape
    raise TypeError(f"cannot reshape array of shape {arr.shape} (size {arr.size}) "
                    f"into shape {orig_newshape} (size {math.prod(newshape)})")
TypeError: cannot reshape array of shape (8000,) (size 8000) into shape (8000, 8000, 8000) (size 512000000000)
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:29<00:00, 33.03it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.5         0.02631579]
 [-0.5        -0.5         0.05263158]
 ...
 [ 0.5         0.5         0.44736842]
 [ 0.5         0.5         0.47368421]
 [ 0.5         0.5         0.5       ]]
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 298, in <module>
    output_path=out_path("output_meshes", "gp_reconstructed_surface.ply")
                ^^^^^^^^
NameError: name 'out_path' is not defined
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:29<00:00, 33.11it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.5         0.02631579]
 [-0.5        -0.5         0.05263158]
 ...
 [ 0.5         0.5         0.44736842]
 [ 0.5         0.5         0.47368421]
 [ 0.5         0.5         0.5       ]]
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 295, in <module>
    extract_mesh(
    ~~~~~~~~~~~~^
        grid_3D, x_data, v_data, k_v, k_fv, sigma,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        grid_res,  # Must match your x_grid generation
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_path=out_path("output_meshes", "gp_reconstructed_surface.ply")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 278, in extract_mesh
    f_grid.numpy(),  # Convert JAX array to NumPy
    ^^^^^^^^^^^^
AttributeError: 'jaxlib._jax.ArrayImpl' object has no attribute 'numpy'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 40.88it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-0.5        -0.5        -0.5       ]
 [-0.5        -0.5        -0.44736842]
 [-0.5        -0.5        -0.39473684]
 ...
 [ 0.5         0.5         0.39473684]
 [ 0.5         0.5         0.44736842]
 [ 0.5         0.5         0.5       ]]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:20<00:00, 48.52it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-10.         -10.         -10.        ]
 [-10.         -10.          -8.94736842]
 [-10.         -10.          -7.89473684]
 ...
 [ 10.          10.           7.89473684]
 [ 10.          10.           8.94736842]
 [ 10.          10.          10.        ]]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:19<00:00, 49.08it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-1.         -1.         -1.        ]
 [-1.         -1.         -0.89473684]
 [-1.         -1.         -0.78947368]
 ...
 [ 1.          1.          0.78947368]
 [ 1.          1.          0.89473684]
 [ 1.          1.          1.        ]]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 40.86it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-2.         -2.         -2.        ]
 [-2.         -2.         -1.78947368]
 [-2.         -2.         -1.57894737]
 ...
 [ 2.          2.          1.57894737]
 [ 2.          2.          1.78947368]
 [ 2.          2.          2.        ]]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:20<00:00, 47.40it/s]Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-1.         -1.         -1.        ]
 [-1.         -1.         -0.89473684]
 [-1.         -1.         -0.78947368]
 ...
 [ 1.          1.          0.78947368]
 [ 1.          1.          0.89473684]
 [ 1.          1.          1.        ]]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator:  47%|███████████████████████████████████████████████████▌                                                          | 458/977 [00:09<00:10, 50.68it/s]Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:21<00:00, 46.44it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-3.14159265 -3.14159265 -3.14159265]
 [-3.14159265 -3.14159265 -2.81089869]
 [-3.14159265 -3.14159265 -2.48020473]
 ...
 [ 3.14159265  3.14159265  2.48020473]
 [ 3.14159265  3.14159265  2.81089869]
 [ 3.14159265  3.14159265  3.14159265]]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 41.88it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-0.31830989 -0.31830989 -0.31830989]
 [-0.31830989 -0.31830989 -0.28480358]
 [-0.31830989 -0.31830989 -0.25129728]
 ...
 [ 0.31830989  0.31830989  0.25129728]
 [ 0.31830989  0.31830989  0.28480358]
 [ 0.31830989  0.31830989  0.31830989]]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 41.30it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-2.         -2.         -2.        ]
 [-2.         -2.         -1.78947368]
 [-2.         -2.         -1.57894737]
 ...
 [ 2.          2.          1.57894737]
 [ 2.          2.          1.78947368]
 [ 2.          2.          2.        ]]
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 299, in <module>
    extract_mesh(
    ~~~~~~~~~~~~^
        grid_3D, x_data, v_data, k_v, k_fv, sigma,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        grid_res,  # Must match your x_grid generation
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_path=out_path("output_meshes", "gp_reconstructed_surface.ply")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 280, in extract_mesh
    vertices, faces, _, _ = marching_cubes(
                            ~~~~~~~~~~~~~~^
        np.array(f_grid),  # Convert JAX array to NumPy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        level=0,
        ^^^^^^^^
        spacing=spacing
        ^^^^^^^^^^^^^^^
    )
    ^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/skimage/measure/_marching_cubes_lewiner.py", line 139, in marching_cubes
    return _marching_cubes_lewiner(
        volume,
    ...<6 lines>...
        mask=mask,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/skimage/measure/_marching_cubes_lewiner.py", line 183, in _marching_cubes_lewiner
    raise ValueError("`spacing` must consist of three floats.")
ValueError: `spacing` must consist of three floats.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:21<00:00, 46.49it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-2.         -2.         -2.        ]
 [-2.         -2.         -1.78947368]
 [-2.         -2.         -1.57894737]
 ...
 [ 2.          2.          1.57894737]
 [ 2.          2.          1.78947368]
 [ 2.          2.          2.        ]]
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 299, in <module>
    extract_mesh(
    ~~~~~~~~~~~~^
        grid_3D, x_data, v_data, k_v, k_fv, sigma,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        grid_res,  # Must match your x_grid generation
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_path=out_path("output_meshes", "gp_reconstructed_surface.ply")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 280, in extract_mesh
    vertices, faces, _, _ = marching_cubes(
                            ~~~~~~~~~~~~~~^
        np.array(f_grid),  # Convert JAX array to NumPy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        level=0,
        ^^^^^^^^
        spacing=spacing
        ^^^^^^^^^^^^^^^
    )
    ^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/skimage/measure/_marching_cubes_lewiner.py", line 139, in marching_cubes
    return _marching_cubes_lewiner(
        volume,
    ...<6 lines>...
        mask=mask,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/skimage/measure/_marching_cubes_lewiner.py", line 224, in _marching_cubes_lewiner
    vertices = vertices * np.r_[spacing]
               ~~~~~~~~~^~~~~~~~~~~~~~~~
ValueError: operands could not be broadcast together with shapes (258,3) (9,)
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:20<00:00, 48.36it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-2.         -2.         -2.        ]
 [-2.         -2.         -1.78947368]
 [-2.         -2.         -1.57894737]
 ...
 [ 2.          2.          1.57894737]
 [ 2.          2.          1.78947368]
 [ 2.          2.          2.        ]]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 41.15it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (8000, 3)
grid_3D
: [[-3.14159265 -3.14159265 -3.14159265]
 [-3.14159265 -3.14159265 -2.81089869]
 [-3.14159265 -3.14159265 -2.48020473]
 ...
 [ 3.14159265  3.14159265  2.48020473]
 [ 3.14159265  3.14159265  2.81089869]
 [ 3.14159265  3.14159265  3.14159265]]
spacing
: [0.33069396 0.33069396 0.33069396]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:24<00:00, 39.56it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (125000, 3)
grid_3D
: [[-3.14159265 -3.14159265 -3.14159265]
 [-3.14159265 -3.14159265 -3.01336438]
 [-3.14159265 -3.14159265 -2.88513611]
 ...
 [ 3.14159265  3.14159265  2.88513611]
 [ 3.14159265  3.14159265  3.01336438]
 [ 3.14159265  3.14159265  3.14159265]]
spacing
: [0.12822827 0.12822827 0.12822827]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 40.84it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (1000000, 3)
grid_3D
: [[-0.5        -0.5        -0.5       ]
 [-0.5        -0.5        -0.48989899]
 [-0.5        -0.5        -0.47979798]
 ...
 [ 0.5         0.5         0.47979798]
 [ 0.5         0.5         0.48989899]
 [ 0.5         0.5         0.5       ]]
spacing
: [0.01010101 0.01010101 0.01010101]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:20<00:00, 46.82it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (1000000, 3)
grid_3D
: [[-3.14159265 -3.14159265 -3.14159265]
 [-3.14159265 -3.14159265 -3.07812614]
 [-3.14159265 -3.14159265 -3.01465962]
 ...
 [ 3.14159265  3.14159265  3.01465962]
 [ 3.14159265  3.14159265  3.07812614]
 [ 3.14159265  3.14159265  3.14159265]]
spacing
: [0.06346652 0.06346652 0.06346652]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:24<00:00, 39.58it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 296, in <module>
    grid_3D = np.mgrid[-box_size:box_size:grid_res*1j, -box_size:box_size:grid_res*1j, -box_size:box_size:grid_res*1j]
              ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/numpy/lib/_index_tricks_impl.py", line 175, in __getitem__
    nn = _nx.indices(size, typ)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/numpy/_core/numeric.py", line 1835, in indices
    res = empty((N,)+dimensions, dtype=dtype)
numpy._core._exceptions._ArrayMemoryError: Unable to allocate 22.4 GiB for an array with shape (3, 1000, 1000, 1000) and data type float64
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 43.41it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (125000000, 3)
grid_3D
: [[-5.         -5.         -5.        ]
 [-5.         -5.         -4.97995992]
 [-5.         -5.         -4.95991984]
 ...
 [ 5.          5.          4.95991984]
 [ 5.          5.          4.97995992]
 [ 5.          5.          5.        ]]
spacing
: [0.02004008 0.02004008 0.02004008]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 42.72it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (1000000, 3)
grid_3D
: [[-2.         -2.         -2.        ]
 [-2.         -2.         -1.95959596]
 [-2.         -2.         -1.91919192]
 ...
 [ 2.          2.          1.91919192]
 [ 2.          2.          1.95959596]
 [ 2.          2.          2.        ]]
spacing
: [0.04040404 0.04040404 0.04040404]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 43.05it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (1000000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53906307]
 [-1.57079633 -1.57079633 -1.50732981]
 ...
 [ 1.57079633  1.57079633  1.50732981]
 [ 1.57079633  1.57079633  1.53906307]
 [ 1.57079633  1.57079633  1.57079633]]
spacing
: [0.03173326 0.03173326 0.03173326]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 100, in <module>
    plt.savefig(out_path("output_pngs", "plot_mesh_cloud_grid.png", bbox_inches="tight"), pad_inches=0, dpi=400)
    ^^^^^^^^^^^
AttributeError: 'Viewer' object has no attribute 'savefig'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 100, in <module>
    meshPlot.savefig(out_path("output_pngs", "plot_mesh_cloud_grid.png", bbox_inches="tight"), pad_inches=0, dpi=400)
    ^^^^^^^^^^^^^^^^
AttributeError: 'Viewer' object has no attribute 'savefig'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 101, in <module>
    meshPlot.screenshot(out_path("output_pngs", "plot_mesh_cloud_grid.png"))
    ^^^^^^^^^^^^^^^^^^^
AttributeError: 'Viewer' object has no attribute 'screenshot'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 103, in <module>
    meshPlot.save_graphic(out_path("output_pngs", "plot_mesh_cloud_grid.png"))
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Viewer' object has no attribute 'save_graphic'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 102, in <module>
    plot = plot_mesh(v, f)
           ^^^^^^^^^
NameError: name 'plot_mesh' is not defined. Did you mean: 'plot_mean'?
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 106, in <module>
    plot.show()  # Interactive window
    ^^^^^^^^^
AttributeError: 'Viewer' object has no attribute 'show'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 106, in <module>
    plot.save(out_path("output_pngs", "plot_mesh_cloud_grid.png", bbox_inches="tight"))
              ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: out_path() got an unexpected keyword argument 'bbox_inches'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.png.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:24<00:00, 40.47it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (1000000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53906307]
 [-1.57079633 -1.57079633 -1.50732981]
 ...
 [ 1.57079633  1.57079633  1.50732981]
 [ 1.57079633  1.57079633  1.53906307]
 [ 1.57079633  1.57079633  1.57079633]]
spacing
: [0.03173326 0.03173326 0.03173326]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
^C
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator:   5%|████▉                                                                                                          | 44/977 [00:01<00:22, 41.59it/s]Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:24<00:00, 39.43it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (1000000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53906307]
 [-1.57079633 -1.57079633 -1.50732981]
 ...
 [ 1.57079633  1.57079633  1.50732981]
 [ 1.57079633  1.57079633  1.53906307]
 [ 1.57079633  1.57079633  1.57079633]]
spacing
: [0.03173326 0.03173326 0.03173326]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:24<00:00, 39.20it/s]
Shape of x_data: (4334, 3)
Shape of v_data: (4334, 3)
Shape of grid_3D: (1000000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53906307]
 [-1.57079633 -1.57079633 -1.50732981]
 ...
 [ 1.57079633  1.57079633  1.50732981]
 [ 1.57079633  1.57079633  1.53906307]
 [ 1.57079633  1.57079633  1.57079633]]
2025-07-23 22:49:56.979661: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 7.12GiB (7649445478 bytes) by rematerialization; only reduced to 8.33GiB (8948723400 bytes), down from 8.33GiB (8948723400 bytes) originally
2025-07-23 22:50:07.250720: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 8.33GiB (rounded to 8947043840)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 22:50:07.250826: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *_**________________________________________________________________________________________________
E0723 22:50:07.250855   17926 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 8947043688 bytes. [tf-allocator-allocation-error='']
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 307, in <module>
    extract_mesh(
    ~~~~~~~~~~~~^
        grid_3D, x_data, v_data, k_v, k_fv, sigma,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        grid_res,  # Must match your x_grid generation
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_path=out_path("output_meshes", "gp_reconstructed_surface.ply")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 273, in extract_mesh
    f_mean = compute_implicit_function_mean(
        x_grid, x_data, v_data, k_v, k_fv, sigma
    )
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 263, in compute_implicit_function_mean
    grid_mean = compute_mean(x_grid, x_data, v_data, k_v, k_fv, sigma)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 137, in compute_mean
    update_query = bmap(update, x_query, bs, verbose, "Computing mean")
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 260, in cache_miss
    _python_pjit_helper(fun, jit_info, *args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 149, in _python_pjit_helper
    out_flat = jit_p.bind(*args_flat, **p.params)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 1126, in process_primitive
    return primitive.impl(*args, **params)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1821, in _pjit_call_impl
    return xc._xla.pjit(
           ~~~~~~~~~~~~~
        name, f, call_impl_cache_miss, [], [], cache_key,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        tree_util.dispatch_registry, pxla.cc_shard_arg,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        _get_cpp_global_cache(cache_key.contains_explicit_attributes))(*args)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1798, in call_impl_cache_miss
    out_flat, compiled, pgle_profiler = _pjit_call_impl_python(
                                        ~~~~~~~~~~~~~~~~~~~~~~^
        *args, jaxpr=jaxpr, in_shardings=in_shardings,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        ctx_mesh=ctx_mesh, name=name, keep_unused=keep_unused,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        inline=inline, compiler_options_kvs=compiler_options_kvs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1777, in _pjit_call_impl_python
    return compiled.unsafe_call(*args), compiled, pgle_profiler
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/profiler.py", line 354, in wrapper
    return func(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/pxla.py", line 1305, in __call__
    results = self.xla_executable.execute_sharded(input_bufs)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 8947043688 bytes.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 42.84it/s]
Shape of x_data: (4334, 3)
Shape of v_data: (4334, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
2025-07-23 22:51:27.984486: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3425] Can't reduce memory use below 7.12GiB (7649445478 bytes) by rematerialization; only reduced to 8.33GiB (8948723400 bytes), down from 8.33GiB (8948723400 bytes) originally
2025-07-23 22:51:38.248567: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 8.33GiB (rounded to 8947043840)requested by op
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2025-07-23 22:51:38.248659: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *_**________________________________________________________________________________________________
E0723 22:51:38.248684   18195 pjrt_stream_executor_client.cc:2939] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 8947043688 bytes. [tf-allocator-allocation-error='']
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 307, in <module>
    extract_mesh(
    ~~~~~~~~~~~~^
        grid_3D, x_data, v_data, k_v, k_fv, sigma,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        grid_res,  # Must match your x_grid generation
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_path=out_path("output_meshes", "gp_reconstructed_surface.ply")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 273, in extract_mesh
    f_mean = compute_implicit_function_mean(
        x_grid, x_data, v_data, k_v, k_fv, sigma
    )
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 263, in compute_implicit_function_mean
    grid_mean = compute_mean(x_grid, x_data, v_data, k_v, k_fv, sigma)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/gp.py", line 137, in compute_mean
    update_query = bmap(update, x_query, bs, verbose, "Computing mean")
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib/geospsr/utils.py", line 23, in bmap
    result.append(f(batch))
                  ~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/api.py", line 1112, in vmap_f
    out_flat = batching.batch(
        flat_fun, axis_data, in_axes_flat,
        lambda: flatten_axes("vmap out_axes", out_tree(), out_axes)
    ).call_wrapped(*args_flat)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
    return self.f_transformed(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 644, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
                  ~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 660, in _batch_inner
    outs = f(*in_tracers)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 342, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 260, in cache_miss
    _python_pjit_helper(fun, jit_info, *args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 149, in _python_pjit_helper
    out_flat = jit_p.bind(*args_flat, **p.params)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/batching.py", line 524, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.axis_data, vals_in, dims_in, **params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 2079, in _pjit_batcher
    vals_out = jit_p.bind(
      *vals_in,
    ...<9 lines>...
      inline=inline,
      compiler_options_kvs=compiler_options_kvs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 576, in bind
    return self._true_bind(*args, **params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 592, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 602, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/core.py", line 1126, in process_primitive
    return primitive.impl(*args, **params)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1821, in _pjit_call_impl
    return xc._xla.pjit(
           ~~~~~~~~~~~~~
        name, f, call_impl_cache_miss, [], [], cache_key,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        tree_util.dispatch_registry, pxla.cc_shard_arg,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        _get_cpp_global_cache(cache_key.contains_explicit_attributes))(*args)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1798, in call_impl_cache_miss
    out_flat, compiled, pgle_profiler = _pjit_call_impl_python(
                                        ~~~~~~~~~~~~~~~~~~~~~~^
        *args, jaxpr=jaxpr, in_shardings=in_shardings,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        ctx_mesh=ctx_mesh, name=name, keep_unused=keep_unused,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        inline=inline, compiler_options_kvs=compiler_options_kvs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/pjit.py", line 1777, in _pjit_call_impl_python
    return compiled.unsafe_call(*args), compiled, pgle_profiler
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/profiler.py", line 354, in wrapper
    return func(*args, **kwargs)
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/jax/_src/interpreters/pxla.py", line 1305, in __call__
    results = self.xla_executable.execute_sharded(input_bufs)
jaxlib._jax.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 8947043688 bytes.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:25<00:00, 37.90it/s]
Shape of x_data: (2776, 3)
Shape of v_data: (2776, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
spacing
: [0.039767 0.039767 0.039767]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:24<00:00, 40.42it/s]
Shape of x_data: (2776, 3)
Shape of v_data: (2776, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
spacing
: [0.039767 0.039767 0.039767]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 43.89it/s]
Shape of x_data: (2776, 3)
Shape of v_data: (2776, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
spacing
: [0.039767 0.039767 0.039767]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 44.19it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 489.73it/s]
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.89it/s]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 788.32it/s]
Computing mean: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:01<00:00, 14.75it/s]
spacing
: [0.039767 0.039767 0.039767]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 42.64it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 426.66it/s]
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.89it/s]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 720.38it/s]
Computing mean: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:00<00:00, 16.62it/s]
spacing
: [0.039767 0.039767 0.039767]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_SPSR_wOneSolve_reconstructed_surface.ply
Running stochastic Poisson surface reconstruction...
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 318, in <module>
    extract_mesh_SPSR(
    ~~~~~~~~~~~~~~~~~^
        P=x_data,                   # Point cloud coordinates (n,3)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        verbose=True
        ^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 256, in extract_mesh_SPSR
    result = stochastic_poisson_surface_reconstruction(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'stochastic_poisson_surface_reconstruction' is not defined
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 41.92it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 515.05it/s]
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.91it/s]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 800.77it/s]
Computing mean: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:00<00:00, 16.11it/s]
spacing
: [0.039767 0.039767 0.039767]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_SPSR_wOneSolve_reconstructed_surface.ply
Running stochastic Poisson surface reconstruction...
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 319, in <module>
    extract_mesh_SPSR(
    ~~~~~~~~~~~~~~~~~^
        P=x_data,                   # Point cloud coordinates (n,3)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        verbose=True
        ^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 257, in extract_mesh_SPSR
    result = stochastic_poisson_surface_reconstruction(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'stochastic_poisson_surface_reconstruction' is not defined
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:24<00:00, 40.08it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 461.44it/s]
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.89it/s]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 762.40it/s]
Computing mean: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:01<00:00, 15.45it/s]
spacing
: [0.039767 0.039767 0.039767]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_SPSR_wOneSolve_reconstructed_surface.ply
Running stochastic Poisson surface reconstruction...
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 319, in <module>
    extract_mesh_SPSR(
    ~~~~~~~~~~~~~~~~~^
        P=x_data,                   # Point cloud coordinates (n,3)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        verbose=True
        ^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 257, in extract_mesh_SPSR
    result = stochastic_poisson_surface_reconstruction(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'stochastic_poisson_surface_reconstruction' is not defined
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:21<00:00, 45.00it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 503.50it/s]
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.89it/s]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 782.37it/s]
Computing mean: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:00<00:00, 16.09it/s]
spacing
: [0.039767 0.039767 0.039767]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_SPSR_wOneSolve_reconstructed_surface.ply
Running stochastic Poisson surface reconstruction...
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 319, in <module>
    extract_mesh_SPSR(
    ~~~~~~~~~~~~~~~~~^
        P=x_data,                   # Point cloud coordinates (n,3)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        verbose=True
        ^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 257, in extract_mesh_SPSR
    result = stochastic_poisson_surface_reconstruction(
        P=P,
    ...<9 lines>...
        prior_fun=prior_fun
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/gpytoolbox/stochastic_poisson_surface_reconstruction.py", line 146, in stochastic_poisson_surface_reconstruction
    assert(gs.shape[0] == dim)
           ^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 43.04it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 280, in <module>
    extract_mesh_SPSR(
    ~~~~~~~~~~~~~~~~~^
        P=x_data,                   # Point cloud coordinates (n,3)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        verbose=True
        ^^^^^^^^^^^^
    )
    ^
TypeError: extract_mesh_SPSR() got an unexpected keyword argument 'gs'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:24<00:00, 39.82it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 280, in <module>
    extract_mesh_SPSR(
    ~~~~~~~~~~~~~~~~~^
        P=x_data,                   # Point cloud coordinates (n,3)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        verbose=True
        ^^^^^^^^^^^^
    )
    ^
TypeError: extract_mesh_SPSR() got an unexpected keyword argument 'corner'
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:23<00:00, 42.41it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
Step 1: Gaussian process interpolation from N to a regular grid
Time to compute k1:  7.198462963104248
Time to compute k2:  0.04087519645690918
Time to compute k1:  6.318623304367065
Time to compute k2:  0.03293156623840332
Time to compute k1:  6.428398847579956
Time to compute k2:  0.03206276893615723
Total step 1 time:  20.110735416412354
Step 2: Solve Poisson equation on the regular grid
Time to compute mean PDE solution:  4.575301170349121
Total step 2 time:  4.575392484664917
Total time:  24.686195611953735
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 280, in <module>
    extract_mesh_SPSR(
    ~~~~~~~~~~~~~~~~~^
        P=x_data,
        ^^^^^^^^^
    ...<3 lines>...
        output_path=out_path("output_meshes", "SPSR_reconstructed_surface.ply"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 259, in extract_mesh_SPSR
    vertices, faces, _, _ = marching_cubes(
                            ~~~~~~~~~~~~~~^
        scalar_mean,
        ^^^^^^^^^^^^
        level=0,
        ^^^^^^^^
        spacing=spacing
        ^^^^^^^^^^^^^^^
    )
    ^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/skimage/measure/_marching_cubes_lewiner.py", line 139, in marching_cubes
    return _marching_cubes_lewiner(
        volume,
    ...<6 lines>...
        mask=mask,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/skimage/measure/_marching_cubes_lewiner.py", line 168, in _marching_cubes_lewiner
    raise ValueError('Input volume should be a 3D numpy array.')
ValueError: Input volume should be a 3D numpy array.
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:22<00:00, 42.71it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
Step 1: Gaussian process interpolation from N to a regular grid
Time to compute k1:  6.843182563781738
Time to compute k2:  0.040205955505371094
Time to compute k1:  6.593306541442871
Time to compute k2:  0.03802180290222168
Time to compute k1:  6.798564910888672
Time to compute k2:  0.03336071968078613
Total step 1 time:  20.412050008773804
Step 2: Solve Poisson equation on the regular grid
Time to compute mean PDE solution:  4.567582130432129
Total step 2 time:  4.56768536567688
Total time:  24.979795932769775
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 286, in <module>
    extract_mesh_SPSR(
    ~~~~~~~~~~~~~~~~~^
        P=x_data,
        ^^^^^^^^^
    ...<3 lines>...
        output_path=out_path("output_meshes", "SPSR_reconstructed_surface.ply"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 265, in extract_mesh_SPSR
    vertices, faces, _, _ = marching_cubes(
                            ~~~~~~~~~~~~~~^
        scalar_mean_3d,  # Now properly 3D
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        level=0,
        ^^^^^^^^
        spacing=spacing
        ^^^^^^^^^^^^^^^
    )
    ^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/skimage/measure/_marching_cubes_lewiner.py", line 139, in marching_cubes
    return _marching_cubes_lewiner(
        volume,
    ...<6 lines>...
        mask=mask,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/skimage/measure/_marching_cubes_lewiner.py", line 224, in _marching_cubes_lewiner
    vertices = vertices * np.r_[spacing]
               ~~~~~~~~~^~~~~~~~~~~~~~~~
ValueError: operands could not be broadcast together with shapes (14084,3) (3,80,80)
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:21<00:00, 45.52it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
Step 1: Gaussian process interpolation from N to a regular grid
Time to compute k1:  8.475108861923218
Time to compute k2:  0.0434572696685791
Time to compute k1:  6.939105749130249
Time to compute k2:  0.038671255111694336
Time to compute k1:  6.696709871292114
Time to compute k2:  0.0337529182434082
Total step 1 time:  22.28894567489624
Step 2: Solve Poisson equation on the regular grid
Time to compute mean PDE solution:  8.893116474151611
Total step 2 time:  8.893211364746094
Total time:  31.182225704193115
Traceback (most recent call last):
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 286, in <module>
    extract_mesh_SPSR(
    ~~~~~~~~~~~~~~~~~^
        P=x_data,
        ^^^^^^^^^
    ...<3 lines>...
        output_path=out_path("output_meshes", "SPSR_reconstructed_surface.ply"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py", line 265, in extract_mesh_SPSR
    vertices, faces, _, _ = marching_cubes(
                            ~~~~~~~~~~~~~~^
        scalar_mean_3d,  # Now properly 3D
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        level=0,
        ^^^^^^^^
        spacing=spacing
        ^^^^^^^^^^^^^^^
    )
    ^
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/skimage/measure/_marching_cubes_lewiner.py", line 139, in marching_cubes
    return _marching_cubes_lewiner(
        volume,
    ...<6 lines>...
        mask=mask,
    )
  File "/home/user/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/skimage/measure/_marching_cubes_lewiner.py", line 224, in _marching_cubes_lewiner
    vertices = vertices * np.r_[spacing]
               ~~~~~~~~~^~~~~~~~~~~~~~~~
ValueError: operands could not be broadcast together with shapes (14084,3) (3,80,80)
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$ PYTHONPATH=~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/build/lib python /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/example_v0.1.py
[CudaDevice(id=0)]
WARNING:absl:Using 'flax.experimental.nnx' is deprecated. Please use 'flax.nnx' instead.
Shape of x_grid: (10000, 3)
x_grid
: [[-0.5        -0.5         0.        ]
 [-0.5        -0.48989899  0.        ]
 [-0.5        -0.47979798  0.        ]
 ...
 [ 0.5         0.47979798  0.        ]
 [ 0.5         0.48989899  0.        ]
 [ 0.5         0.5         0.        ]]
Shape of f_grid: (19602, 3)
Shape of x1_grid: (100, 100)
Shape of x2_grid: (100, 100)
Renderer(camera=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), controls=[OrbitControls(controlling=PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), target=(0.0, 0.0, 0.0))], scene=Scene(children=(PerspectiveCamera(children=(DirectionalLight(color='white', intensity=0.6, position=(0.0, 0.0, 7.309295807795946), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)),), fov=30.0, position=(0.0, 0.0, 7.309295807795946), projectionMatrix=(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), AmbientLight(intensity=0.5, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), Mesh(geometry=BufferGeometry(attributes={'color': <BufferAttribute shape=(6315, 3), dtype=float32>, 'index': <BufferAttribute shape=(37878,), dtype=uint32>, 'position': <BufferAttribute shape=(6315, 3), dtype=float32>}), material=MeshStandardMaterial(alphaMap=None, aoMap=None, bumpMap=None, defines={'STANDARD': ''}, displacementMap=None, emissiveMap=None, envMap=None, flatShading=True, lightMap=None, map=None, metalness=0.25, metalnessMap=None, normalMap=None, normalScale=(1.0, 1.0), polygonOffset=True, polygonOffsetFactor=1.0, polygonOffsetUnits=5.0, roughnessMap=None, side='DoubleSide', vertexColors='VertexColors'), position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0))), fog=None, overrideMaterial=None, position=(0.0, 0.0, 0.0), quaternion=(0.0, 0.0, 0.0, 1.0), rotation=(0.0, 0.0, 0.0, 'XYZ'), scale=(1.0, 1.0, 1.0), up=(0.0, 1.0, 0.0)), shadowMap=WebGLShadowMap())
Plot saved to file /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_pngs/plot_mesh_cloud_grid.html.
Creating interpolator: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 977/977 [00:21<00:00, 44.70it/s]
Shape of x_data: (691, 3)
Shape of v_data: (691, 3)
Shape of grid_3D: (512000, 3)
grid_3D
: [[-1.57079633 -1.57079633 -1.57079633]
 [-1.57079633 -1.57079633 -1.53102933]
 [-1.57079633 -1.57079633 -1.49126234]
 ...
 [ 1.57079633  1.57079633  1.49126234]
 [ 1.57079633  1.57079633  1.53102933]
 [ 1.57079633  1.57079633  1.57079633]]
Step 1: Gaussian process interpolation from N to a regular grid
Time to compute k1:  8.806950330734253
Time to compute k2:  0.04221391677856445
Time to compute k1:  7.339334487915039
Time to compute k2:  0.04699540138244629
Time to compute k1:  7.280525207519531
Time to compute k2:  0.03792905807495117
Total step 1 time:  23.610409021377563
Step 2: Solve Poisson equation on the regular grid
Time to compute mean PDE solution:  12.162344932556152
Total step 2 time:  12.162454605102539
Total time:  35.772944688797
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/SPSR_reconstructed_surface.ply
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:03<00:00, 250.42it/s]
Computing mean: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.15it/s]
SDD: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:02<00:00, 447.71it/s]
Computing mean: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:01<00:00,  9.57it/s]
spacing
: [0.039767 0.039767 0.039767]
Mesh saved to /mnt/h/Hands-on_AI_based_3D_Vision/HandsOn_Project_11/GeoSPSR/experiments/output_meshes/gp_SPSR_wOneSolve_reconstructed_surface.ply
(GeoSPSR_uv) user@KirianPC:~/HandsOnProject_11/HandsOn_Project_11/GeoSPSR/GeoSPSR_uv/lib/python3.13/site-packages/meshplot$